---
title: "DGE_viz"
output: html_document
date: "2024-02-05"
---

```{r}
treatmentinfo.control2  <- treatmentinfo.2 %>% filter(tissue == "F") %>%
  filter(!( tissue == "G"))

treatmentinfo.control2 <- treatmentinfo.control2 %>%
  mutate(treatment = ifelse(day == "3" & treatment == "control", paste0(treatment, "_3"), treatment))

countmatrix_truecon <- subset(countmatrix_2, select=row.names(treatmentinfo.control2))

dds3 <- DESeqDataSetFromMatrix(countData = countmatrix_truecon,
                              colData = treatmentinfo.control2,
                              design = ~ treatment)

dds3 <- DESeq(dds3)
resultsNames(dds3) # lists the coefficients
summary(dds3)

PCAdata <- plotPCA(vst(dds3), intgroup = c("treatment"), returnData=TRUE)
percentVar <- round(100*attr(PCAdata, "percentVar")) #plot PCA of samples with all data
ggplot(PCAdata, aes(PC1, PC2, color=treatment)) + 
  geom_point(size=4, alpha = 5/10) +
  xlab(paste0("PC1: ",percentVar[1],"% variance")) +
  ylab(paste0("PC2: ",percentVar[2],"% variance")) + 
  coord_fixed()+
  stat_ellipse(level=0.8)

```

